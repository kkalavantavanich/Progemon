package graphic;

import javafx.animation.AnimationTimer;
import javafx.event.EventHandler;
import javafx.scene.Scene;
import javafx.scene.input.KeyEvent;
import javafx.scene.input.MouseEvent;
import javafx.scene.layout.Pane;
import javafx.scene.paint.Color;
import javafx.stage.Stage;
import utility.InputUtility;

public class MyStage extends Stage {
	
	public MyStage() {
		// TODO Auto-generated constructor stub
		super();
		setTitle("Progemon");
		MyCanvas canvas = new MyCanvas();
		Pane root = new Pane();
		root.getChildren().add(canvas);
		Scene scene = new Scene(root, 800, 600, Color.DARKGRAY);
		setScene(scene);
		addListener(scene);
		setX(0);
		setY(0);
		new AnimationTimer() {
			
			@Override
			public void handle(long now) {
				// TODO Auto-generated method stub
				System.out.println("reach");
			}
		}.start();
		show();
	}
	
	public void addListener(Scene scene){
		scene.setOnMouseClicked(new EventHandler<MouseEvent>() {

			@Override
			public void handle(MouseEvent mEvent) {
				// TODO Auto-generated method stub
				InputUtility.setLastMouseClickEvent(mEvent);
			}
		});
		
		scene.setOnMouseMoved(new EventHandler<MouseEvent>() {

			@Override
			public void handle(MouseEvent mEvent) {
				// TODO Auto-generated method stub
				InputUtility.setLastMouseMoveEvent(mEvent);
				InputUtility.setMouseX((int) mEvent.getX());
				InputUtility.setMouseY((int) mEvent.getY());
			}
		});
		
		scene.setOnKeyPressed(new EventHandler<KeyEvent>() {

			@Override
			public void handle(KeyEvent kEvent) {
				// TODO Auto-generated method stub
				InputUtility.addEvents(kEvent);
				InputUtility.addKeys(kEvent);
				InputUtility.setLastKeyEvent(kEvent);
			}
		});
		
		scene.setOnKeyReleased(new EventHandler<KeyEvent>() {

			@Override
			public void handle(KeyEvent kEvent) {
				// TODO Auto-generated method stub
				InputUtility.addEvents(kEvent);
				InputUtility.removeHoldingKeys(kEvent);
				InputUtility.setLastKeyEvent(kEvent);
			}
		});
	}

}
